# needsMoreInfo æµç¨‹ä¿®å¤æ€»ç»“

## é—®é¢˜è¯Šæ–­

### åŸå§‹é—®é¢˜
ç”¨æˆ·è¯¢é—® "C300 æ¨è–¦æ©Ÿæ²¹" æ—¶ï¼š
- AI åˆ†æé˜¶æ®µæ­£ç¡®è¯†åˆ«äº† `needsMoreInfo: ["å¹´ä»½", "ç‡ƒæ²¹é¡å‹"]`
- ä½† LLM æœ€ç»ˆ**æ²¡æœ‰è¿½é—®ç”¨æˆ·**ï¼Œè€Œæ˜¯ç›´æ¥æ¨èäº†äº§å“

### æ ¹æœ¬åŸå› 
`needsMoreInfo` åœ¨æµç¨‹ä¸­è¢«ä¸¢å¤±ï¼Œæœªä¼ é€’ç»™ LLMï¼š

1. âŒ **intent-converter.js** - æ²¡æœ‰å°† `needsMoreInfo` æå–åˆ° intent é¡¶å±‚
2. âŒ **prompt-builder.js** - åªæœ‰æ·»åŠ åŠ‘çš„ `needsMoreInfo` å¤„ç†é€»è¾‘
3. âŒ **agent-prompts.js** - `buildOilPrompt` å®Œå…¨æ²¡æœ‰æ£€æŸ¥ `needsMoreInfo`
4. âŒ **LLM** - æ”¶åˆ°çš„ prompt ä¸­æ²¡æœ‰"éœ€è¦è¿½é—®"çš„æŒ‡ä»¤

---

## ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤ 1: intent-converter.js (ç¬¬ 99-100 è¡Œ)

**æ–‡ä»¶**: `lib/intent-converter.js`

**å˜æ›´**: åœ¨ intent å¯¹è±¡ä¸­æ·»åŠ  `needsMoreInfo` å­—æ®µæå–

```javascript
const intent = {
    // ... å…¶ä»–å­—æ®µ ...
    detectedKeywords: aiResult.searchKeywords || [],

    // âš¡ æ–°å¢ï¼šæå– needsMoreInfo åˆ° intent é¡¶å±‚
    needsMoreInfo: aiResult.needsMoreInfo || [],

    // ä¿ç•™ AI åˆ†æçš„å®Œæ•´è³‡è¨Šä¾›å¾ŒçºŒä½¿ç”¨
    _aiAnalysis: aiResult
};
```

**ä½œç”¨**: ç¡®ä¿ AI åˆ†æçš„ `needsMoreInfo` è¢«æå–åˆ° intent é¡¶å±‚ï¼Œæ–¹ä¾¿åç»­æµç¨‹è®¿é—®ã€‚

---

### ä¿®å¤ 2: prompt-builder.js (ç¬¬ 264-298 è¡Œ)

**æ–‡ä»¶**: `lib/prompt-builder.js`

**å˜æ›´**: åœ¨ `buildIntentInstructions` å‡½æ•°æœ«å°¾æ·»åŠ é€šç”¨çš„ `needsMoreInfo` å¤„ç†é€»è¾‘

```javascript
// âš¡ æ–°å¢ï¼šé€šç”¨çš„ needsMoreInfo è™•ç†é‚è¼¯ï¼ˆé©ç”¨æ–¼æ‰€æœ‰ç”¢å“é¡åˆ¥ï¼‰
// ç•¶ AI è­˜åˆ¥å‡ºéœ€è¦è¿½å•çš„è³‡è¨Šæ™‚ï¼Œç”Ÿæˆè¿½å•æŒ‡ä»¤
const needsInfo = intent?.needsMoreInfo || intent?._aiAnalysis?.needsMoreInfo || [];
if (needsInfo.length > 0 && intent.type === 'product_recommendation') {
    const productCategory = intent?.productCategory || 'ç”¢å“';

    // æ ¹æ“šç”¢å“é¡åˆ¥ç”Ÿæˆè¿½å•æç¤º
    let followUpGuide = '';
    if (productCategory === 'æ©Ÿæ²¹') {
        followUpGuide = `**æ±½è»Šæ©Ÿæ²¹æ¨è–¦å‰å¿…é ˆç¢ºèªï¼šå¹´ä»½ã€è»Šå‹åç¨±ã€ç‡ƒæ²¹é¡å‹ï¼ˆæ±½æ²¹/æŸ´æ²¹/æ²¹é›»ï¼‰**
**æ©Ÿè»Šæ©Ÿæ²¹æ¨è–¦å‰å¿…é ˆç¢ºèªï¼šè»Šå‹é¡åˆ¥ï¼ˆæª”è»Š/é€Ÿå…‹é”ï¼‰ã€æ’æ°£é‡ï¼ˆé¸å¡«ï¼‰**`;
    } else if (productCategory === 'æ·»åŠ åŠ‘') {
        followUpGuide = `**æ·»åŠ åŠ‘æ¨è–¦å‰å¿…é ˆç¢ºèªï¼šè»Šç¨®ã€ç—‡ç‹€ã€è®Šé€Ÿç®±é¡å‹**`;
    } else {
        followUpGuide = `**æ¨è–¦${productCategory}å‰å¿…é ˆç¢ºèªå®Œæ•´çš„è»Šå‹è³‡è¨Š**`;
    }

    return `## ğŸ›‘ äº’å‹•æŒ‡å° (Product Recommendation - è³‡è¨Šä¸è¶³)
ç”¨æˆ¶è©¢å•${productCategory}æ¨è–¦ï¼Œä½†ç¼ºå°‘å¿…è¦çš„è³‡è¨Šã€‚

**âš ï¸ AI åˆ†æçµæœï¼šéœ€è¦ç¢ºèªçš„è³‡è¨Š**
${needsInfo.map(info => `- ${info}`).join('\n')}

**è«‹åš´æ ¼åŸ·è¡Œä»¥ä¸‹å‹•ä½œï¼š**
1. **â›” ç¦æ­¢ç›´æ¥æ¨è–¦ç”¢å“**ï¼šè³‡è¨Šä¸è¶³æ™‚æ¨è–¦å¯èƒ½ä¸æº–ç¢ºï¼
2. **è¿½å•ç¼ºå°‘çš„è³‡è¨Š**ï¼šç¦®è²Œåœ°è©¢å•ç”¨æˆ¶ç¼ºå°‘çš„è³‡è¨Š
3. **èªªæ˜ç‚ºä½•éœ€è¦é€™äº›è³‡è¨Š**ï¼šå¹«åŠ©ç”¨æˆ¶ç†è§£ç‚ºä½•éœ€è¦æä¾›é€™äº›è³‡è¨Š

${followUpGuide}

**ç¯„ä¾‹å›è¦†ï¼š**
ã€Œæ‚¨å¥½ï¼é—œæ–¼æ‚¨çš„ ${intent?.vehicleModel || 'è»Šå‹'}ï¼Œç‚ºäº†æ¨è–¦æœ€é©åˆçš„${productCategory}ï¼Œæˆ‘éœ€è¦ç¢ºèªä¸€ä¸‹ï¼š
${needsInfo.map((info, idx) => `${idx + 1}. è«‹å•${info}æ˜¯ä»€éº¼å‘¢ï¼Ÿ`).join('\n')}
é€™äº›è³‡è¨Šèƒ½å¹«åŠ©æˆ‘æ¨è–¦æœ€ç¬¦åˆåŸå» è¦ç¯„çš„ç”¢å“ï¼ã€`;
}
```

**ä½œç”¨**: æ‰©å±•é€»è¾‘ï¼Œä½¿å…¶ä¸ä»…å¤„ç†æ·»åŠ åŠ‘ï¼Œè¿˜èƒ½å¤„ç†æœºæ²¹ç­‰æ‰€æœ‰äº§å“çš„ `needsMoreInfo`ã€‚

---

### ä¿®å¤ 3: agent-prompts.js (ç¬¬ 157-185 è¡Œ)

**æ–‡ä»¶**: `lib/agent-prompts.js`

**å˜æ›´**: åœ¨ `buildOilPrompt` å¼€å¤´æ·»åŠ  `needsMoreInfo` æ£€æŸ¥é€»è¾‘

```javascript
function buildOilPrompt(knowledge, intent, productContext) {
    const sections = [];

    sections.push(getLanguageRule());
    sections.push(getCoreIdentity());

    // âš¡ æ–°å¢ï¼šæª¢æŸ¥æ˜¯å¦éœ€è¦è¿½å•è³‡è¨Š
    const needsInfo = intent?.needsMoreInfo || intent?._aiAnalysis?.needsMoreInfo || [];
    if (needsInfo.length > 0) {
        // ç”Ÿæˆè¿½å•æŒ‡ä»¤
        sections.push(`## ğŸ›‘ äº’å‹•æŒ‡å° (Oil Recommendation - è³‡è¨Šä¸è¶³)
ç”¨æˆ¶è©¢å•æ©Ÿæ²¹æ¨è–¦ï¼Œä½†ç¼ºå°‘å¿…è¦çš„è³‡è¨Šã€‚

**âš ï¸ AI åˆ†æçµæœï¼šéœ€è¦ç¢ºèªçš„è³‡è¨Š**
${needsInfo.map(info => `- ${info}`).join('\n')}

**è«‹åš´æ ¼åŸ·è¡Œä»¥ä¸‹å‹•ä½œï¼š**
1. **â›” ç¦æ­¢ç›´æ¥æ¨è–¦ç”¢å“**ï¼šè³‡è¨Šä¸è¶³æ™‚æ¨è–¦å¯èƒ½ä¸ç¬¦åˆåŸå» è¦ç¯„ï¼
2. **è¿½å•ç¼ºå°‘çš„è³‡è¨Š**ï¼šç¦®è²Œåœ°è©¢å•ç”¨æˆ¶ç¼ºå°‘çš„è³‡è¨Š
3. **èªªæ˜ç‚ºä½•éœ€è¦é€™äº›è³‡è¨Š**ï¼šä¾‹å¦‚ã€Œå¹´ä»½æœƒå½±éŸ¿èªè­‰è¦ç¯„ã€

**æ±½è»Šæ©Ÿæ²¹æ¨è–¦å‰å¿…é ˆç¢ºèªï¼šå¹´ä»½ã€è»Šå‹åç¨±ã€ç‡ƒæ²¹é¡å‹ï¼ˆæ±½æ²¹/æŸ´æ²¹/æ²¹é›»ï¼‰**
**æ©Ÿè»Šæ©Ÿæ²¹æ¨è–¦å‰å¿…é ˆç¢ºèªï¼šè»Šå‹é¡åˆ¥ï¼ˆæª”è»Š/é€Ÿå…‹é”ï¼‰ã€æ’æ°£é‡ï¼ˆé¸å¡«ï¼‰**

**ç¯„ä¾‹å›è¦†ï¼š**
ã€Œæ‚¨å¥½ï¼é—œæ–¼æ‚¨çš„ ${intent?.vehicleModel || 'è»Šå‹'}ï¼Œç‚ºäº†æ¨è–¦æœ€é©åˆçš„æ©Ÿæ²¹ï¼Œæˆ‘éœ€è¦ç¢ºèªä¸€ä¸‹ï¼š
${needsInfo.map((info, idx) => `${idx + 1}. è«‹å•${info}æ˜¯ä»€éº¼å‘¢ï¼Ÿ`).join('\n')}
é€™äº›è³‡è¨Šèƒ½å¹«åŠ©æˆ‘æ¨è–¦æœ€ç¬¦åˆåŸå» è¦ç¯„çš„ç”¢å“ï¼ã€

**âš ï¸ ç¦æ­¢é¡¯ç¤ºè³¼è²·æŒ‡å¼•**ï¼šå°šæœªæ¨è–¦ç”¢å“æ™‚ä¸éœ€è¦è³¼è²·æŒ‡å¼•`);

        // âš ï¸ å¦‚æœéœ€è¦è¿½å•ï¼Œä¸é¡¯ç¤ºç”¢å“è³‡æ–™ï¼Œé¿å… LLM ç›´æ¥æ¨è–¦
        sections.push(buildFinalReminder(true, { includeDisclaimer: false, includePurchaseGuide: false }));
        return sections.filter(s => s).join('\n\n');
    }

    // ... æ­£å¸¸çš„æœºæ²¹æ¨èæµç¨‹ ...
}
```

**ä½œç”¨**:
- åœ¨æ„å»ºæœºæ²¹ prompt å‰æ£€æŸ¥ `needsMoreInfo`
- å¦‚æœæœ‰ç¼ºå¤±ä¿¡æ¯ï¼Œç”Ÿæˆè¿½é—®æŒ‡ä»¤è€Œä¸æ˜¯ç›´æ¥æ¨è
- ä¸æ˜¾ç¤ºäº§å“èµ„æ–™ï¼Œé¿å… LLM çœ‹åˆ°äº§å“åç›´æ¥æ¨è

---

## ä¿®å¤åçš„å®Œæ•´æµç¨‹

### åœºæ™¯ï¼šç”¨æˆ·è¯¢é—® "C300 æ¨è–¦æ©Ÿæ²¹"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: AI åˆ†æ (analyze.js)                                 â”‚
â”‚ âœ“ è¯†åˆ«: needsMoreInfo = ["å¹´ä»½", "ç‡ƒæ²¹é¡å‹"]                  â”‚
â”‚ âœ“ è¿”å›: aiResult åŒ…å« needsMoreInfo                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: Intent è½¬æ¢ (intent-converter.js)                    â”‚
â”‚ âœ“ æå–: intent.needsMoreInfo = ["å¹´ä»½", "ç‡ƒæ²¹é¡å‹"]           â”‚
â”‚ âœ“ ä¿å­˜: intent._aiAnalysis ä¿ç•™å®Œæ•´æ•°æ®                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: Agent é€‰æ‹© (agent-prompts.js)                        â”‚
â”‚ âœ“ é€‰æ‹©: product_oil agent                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: Prompt æ„å»º (agent-prompts.js - buildOilPrompt)     â”‚
â”‚ âœ“ æ£€æŸ¥: needsMoreInfo.length > 0                            â”‚
â”‚ âœ“ ç”Ÿæˆ: è¿½é—®æŒ‡ä»¤ï¼ˆç¦æ­¢æ¨èäº§å“ï¼‰                               â”‚
â”‚ âœ“ éšè—: äº§å“èµ„æ–™åº“ï¼ˆé¿å… LLM çœ‹åˆ°åç›´æ¥æ¨èï¼‰                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: LLM å¤„ç†                                             â”‚
â”‚ âœ“ æ”¶åˆ°: "ç¦æ­¢ç›´æ¥æ¨èäº§å“ï¼Œè¿½é—®å¹´ä»½å’Œç‡ƒæ²¹ç±»å‹"                  â”‚
â”‚ âœ“ å›å¤: è¿½é—®ç”¨æˆ·å¹´ä»½å’Œç‡ƒæ²¹ç±»å‹                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æµ‹è¯•ç»“æœ

è¿è¡Œ `node test-needsMoreInfo-flow.js`ï¼š

```
=== æµ‹è¯• needsMoreInfo æµç¨‹ ===

Step 1: æµ‹è¯• intent-converter.js
  needsMoreInfo (é¡¶å±‚): [ 'å¹´ä»½', 'ç‡ƒæ²¹é¡å‹' ]
  âœ… needsMoreInfo å·²æˆåŠŸæå–åˆ° intent é¡¶å±‚

Step 2: æµ‹è¯• agent é€‰æ‹©
  é€‰æ‹©çš„ Agent: product_oil
  âœ… åº”è¯¥é€‰æ‹© product_oil agent

Step 3: æµ‹è¯• buildOilPrompt
  âœ… Prompt åŒ…å«è¿½é—®æŒ‡ä»¤ (ğŸ›‘ äº’å‹•æŒ‡å°)
  âœ… Prompt æåˆ°äº†"å¹´ä»½"
  âœ… Prompt æåˆ°äº†"ç‡ƒæ²¹é¡å‹"
  âœ… Prompt åŒ…å«ç¦æ­¢æ¨èæŒ‡ä»¤

Step 4: æµ‹è¯•å®Œæ•´æµç¨‹ï¼ˆä½¿ç”¨ buildPromptï¼‰
  âœ… å®Œæ•´æµç¨‹æµ‹è¯•é€šè¿‡ï¼šneedsMoreInfo å·²æˆåŠŸä¼ é€’åˆ° LLM Prompt
```

---

## å®é™…æ•ˆæœå¯¹æ¯”

### ä¿®å¤å‰ âŒ
- ç”¨æˆ·: "C300 æ¨è–¦æ©Ÿæ²¹"
- AI åˆ†æ: needsMoreInfo = ["å¹´ä»½", "ç‡ƒæ²¹é¡å‹"]
- LLM å›å¤: ç›´æ¥æ¨è LM2327, LM21222, LM21178ï¼ˆ**é”™è¯¯ï¼**ï¼‰

### ä¿®å¤å âœ…
- ç”¨æˆ·: "C300 æ¨è–¦æ©Ÿæ²¹"
- AI åˆ†æ: needsMoreInfo = ["å¹´ä»½", "ç‡ƒæ²¹é¡å‹"]
- LLM å›å¤: "æ‚¨å¥½ï¼é—œæ–¼æ‚¨çš„ Mercedes-Benz C300ï¼Œç‚ºäº†æ¨è–¦æœ€é©åˆçš„æ©Ÿæ²¹ï¼Œæˆ‘éœ€è¦ç¢ºèªä¸€ä¸‹ï¼š
  1. è«‹å•å¹´ä»½æ˜¯ä»€éº¼å‘¢ï¼Ÿ
  2. è«‹å•ç‡ƒæ²¹é¡å‹æ˜¯ä»€éº¼å‘¢ï¼Ÿ
  é€™äº›è³‡è¨Šèƒ½å¹«åŠ©æˆ‘æ¨è–¦æœ€ç¬¦åˆåŸå» è¦ç¯„çš„ç”¢å“ï¼"

---

## é€‚ç”¨åœºæ™¯

è¿™ä¸ªä¿®å¤é€‚ç”¨äºæ‰€æœ‰äº§å“ç±»åˆ«çš„æ¨èåœºæ™¯ï¼š

1. **æœºæ²¹æ¨è** - ç¼ºå°‘å¹´ä»½ã€ç‡ƒæ²¹ç±»å‹æ—¶è¿½é—®
2. **æ·»åŠ åŠ‘æ¨è** - ç¼ºå°‘è½¦ç§ã€ç—‡çŠ¶æ—¶è¿½é—®
3. **å…¶ä»–äº§å“æ¨è** - ç¼ºå°‘å…³é”®ä¿¡æ¯æ—¶è¿½é—®

---

## æŠ€æœ¯ç»†èŠ‚

### å…³é”®è®¾è®¡å†³ç­–

1. **åŒé‡æ£€æŸ¥æœºåˆ¶**
   ```javascript
   const needsInfo = intent?.needsMoreInfo || intent?._aiAnalysis?.needsMoreInfo || [];
   ```
   åŒæ—¶æ£€æŸ¥é¡¶å±‚å’Œ `_aiAnalysis`ï¼Œç¡®ä¿å‘åå…¼å®¹ã€‚

2. **æå‰è¿”å›ç­–ç•¥**
   ```javascript
   if (needsInfo.length > 0) {
       // ç”Ÿæˆè¿½é—®æŒ‡ä»¤
       return sections.filter(s => s).join('\n\n');  // æå‰è¿”å›
   }
   // æ­£å¸¸æµç¨‹...
   ```
   å¦‚æœéœ€è¦è¿½é—®ï¼Œç«‹å³è¿”å›è¿½é—® promptï¼Œé¿å…æ‰§è¡Œåç»­çš„äº§å“æ¨èé€»è¾‘ã€‚

3. **éšè—äº§å“èµ„æ–™**
   å½“éœ€è¦è¿½é—®æ—¶ï¼Œä¸ä¼ é€’äº§å“èµ„æ–™ç»™ LLMï¼Œé¿å…å…¶çœ‹åˆ°äº§å“åå¿½ç•¥è¿½é—®æŒ‡ä»¤ã€‚

---

## ç»´æŠ¤å»ºè®®

1. **æ–°å¢äº§å“ç±»åˆ«æ—¶**
   - åœ¨ `prompt-builder.js` çš„ `buildIntentInstructions` ä¸­æ·»åŠ å¯¹åº”çš„ `followUpGuide`
   - åœ¨ `agent-prompts.js` ä¸­åˆ›å»ºå¯¹åº”çš„ agent prompt builder

2. **ä¿®æ”¹è¿½é—®é€»è¾‘æ—¶**
   - ç¡®ä¿ `intent-converter.js`ã€`prompt-builder.js` å’Œ `agent-prompts.js` ä¿æŒä¸€è‡´
   - è¿è¡Œ `test-needsMoreInfo-flow.js` éªŒè¯ä¿®æ”¹

3. **è°ƒè¯•æŠ€å·§**
   - æ£€æŸ¥æ—¥å¿—ä¸­çš„ `[IntentConverter] Converted AI result to intent` ç¡®è®¤ `needsMoreInfo` æ˜¯å¦æå–
   - æ£€æŸ¥æ—¥å¿—ä¸­çš„ `[PromptBuilder] Multi-Agent mode` ç¡®è®¤ prompt é•¿åº¦æ˜¯å¦åˆç†
   - æ£€æŸ¥ LLM å›å¤æ˜¯å¦åŒ…å«è¿½é—®å†…å®¹

---

## ç›¸å…³æ–‡ä»¶

- `lib/intent-converter.js` - Intent è½¬æ¢é€»è¾‘
- `lib/prompt-builder.js` - Prompt æ„å»ºé€»è¾‘ï¼ˆLegacy æ¨¡å¼ï¼‰
- `lib/agent-prompts.js` - Multi-Agent Prompt æ„å»ºé€»è¾‘
- `test-needsMoreInfo-flow.js` - æµ‹è¯•è„šæœ¬

---

## ä½œè€…

ä¿®å¤æ—¥æœŸ: 2026-01-07
ä¿®å¤è€…: Claude Sonnet 4.5
